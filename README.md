# gitlabber

Gitlab Bot and API dispatcher

## Gitlab Account Setup

Ensure you have a dedicated user created in gitlab, e.g. @gitlabber
Invite @gitlabber to join your project in a maintainer role.
generate a `Personal Access Token` token with `api`-only privileges, e.g.

```
Name: gitlabber-api-token
Expires at: 3021-06-01
Personal Access Token:  4zy7p865asd6i#524TozZjyY
```

> Note:  alternatively, `Project Access Token` could be used with `api` privileges

## Setup gitlabber

Pick a `secret` token for authentication (preferred) or start gitlabber without it - short-lived `secret` token will be autogenerated for you, e.g.

```
66a81121-a99c-41cd-92d0-f8b47d36f4fa
```

> Note: the `secret` token is used for webhook authentication.  It's best to pre-generate it, so that it could be registered in gitlab for webhook authentication.

## Start gitlabber

Start gitlabber using the personal access token and gitlabber secret token for bidirectional authentication, pass the gitlab api url and the project id, e.g.

```
./gitlabber agent --token "4zy7p865asd6ig524TozZjyY" --logLevel debug --port 8080 --secret "66a81121-a99c-41cd-92d0-f8b47d36f4fa" --url "https://gitlab.com/api/v4" --project 737
```

You should see :

```
DEBU[0000] Setting loglevel to 'debug'
INFO[0000] Listening on port '8080'
INFO[0000] Using secret '66a81121-a99c-41cd-92d0-f8b47d36f4fa'
INFO[0000] Using project url 'https://gitlab.com/api/v4/projects/737'
```

At this time, gitlabber is now listening for gitlab webhooks

## Debug

Try, while gitlabber is running on port 80:

```
http://gitlabber-host/api/3/status
```

